---
title: 知能情報システム研究室　活動記録　5月
tags: AI Python 強化学習 機械学習 転移学習
author: Tsora1216
slide: false
---
::: note info
この記事は下記のURLを参考に作成されたMD形式の記事です。
:::

https://qiita.com/Qiita/items/c686397e4a0f4f11683d

## 2023/05/01～2023/05/07の活動
* 学習
    * SIGNATE
        * 銀行の顧客ターゲティング
            * 現在ランクTier1~7の最下層Tier7に所属中
            * 勾配ブースティング（XGBoost）のアルゴリズムに変換
            * →0.81に記録更新
            * 現在ランクTier6に昇格
            * XGBoostとランダムフォレストのアンサンブル学習を実装
            * →記録に変化なし
        * 携帯電話の機能データからの価格帯分類
            * ランキング付与の大会に参加
            * Tier5を目指して奮闘中
## 2023/05/08～2023/05/14の活動
* 学習
    * G検定
        * お勉強本格的に開始
        * 3日間をほぼ寝ずに貫徹
        * 受験終了
        * Acctually=0.72?
    * SIGNATE
        * 携帯電話の機能データからの価格帯分類
            * 現在ランクTier5に昇格
            * 全体で9位にランクイン
            * 圧倒的なスコアでクリアラインを超えるスコア
            * 試行した施策
                * 0.3950：ロジスティック回帰->0.39
                * 0.3828：決定木
                * 0.4253：サポートベクターマシン
                * 0.4598：ランダムフォレスト
                * 0.4165：ニューラルネットワーク（シグモイド）
                * 0.4385：ランダムフォレストモデル＋IQRによる外れ値除外
                * 0.4402：ランダムフォレスト＋XGBoostアンサンブル＋特徴量エンジニアリング
                * 0.4783：LightGBM
                * 0.4543：LightGBM＋グリッドサーチによるハイパーパラメータの最適化
                * 0.4245：LightGBM＋層化K分割交差検証 (K=5)＋相関係数から特徴量選択
                * 0.4666：LightGBM＋特徴量エンジニアリング
                * 0.4589：LightGBM＋層化K分割交差検証 (K=100)
                * 0.4804：LightGBM＋層化K分割交差検証 (K=7)
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/2502107/95e8d435-c0c9-032e-94d5-96263190ff12.png)

## 2023/05/15～2023/05/21の活動
* 学習
    * Nishika
        * 睡眠段階の判定 〜”睡眠の深さを判別しよう”〜
            * パワースペクトル密度による特徴量エンジニアリング
            * モデルには、ランダムフォレストを使用
            * 暫定スコア0.652を記録、順位は全体90位にランクイン
* 研究
    * 電気学会に発表申し込み
    * SAP-netの構築開始
        * SAP-net→意味＋活性化＋ネットワーク＝自然言語処理＋ネットワーク
        * 自然言語処理の学習
            * Word2Vec→意味の近さをベクトルで表現
            * 近い言葉だが、PCには判別しづらそうなものを提示（群馬、埼玉）
            * ↑文字列や数字として理解せず、意味を理解する必要がある。
            * Word2Vecで文字列をベクトルに変換し、ベクトルの近さから文字列の類似度を高次元で測る
            * input：群馬,TOP7
            * output：[('群馬県', 0.7760874032974243), ('栃木', 0.7456161379814148), ('前橋', 0.7389767169952393), ('埼玉', 0.7216979265213013), ('高崎', 0.6891007423400879), ('伊勢崎', 0.6693983674049377), ('茨城', 0.6651455163955688)]
            * input：群馬,Positive Score>0.5
            * ['群馬県', '栃木', '前橋', '埼玉', '高崎', '伊勢崎', '茨城', '高崎市', '群馬県前橋市', '栃木県']
            * 意味をベクトルで表現できたことにより、文字列の計算が出来る
            * 「？？」−「群馬」＝「宇都宮」−「栃木」
            * 上記の指揮を変形し、「？？」＝「宇都宮」－「栃木」＋「群馬」で群馬の県庁所在地を求めました
            * [('前橋', 0.7003206014633179)]
            * 高崎にお住まいの方残念でした。
            * ちなみに東北地方の茨城県でも試みたところ、笠間と出ました。よって水戸は消滅いたしました。
## 2023/05/22～2023/05/28の活動
* 研究
    * 電気学会に発表申し込み
        * ネットワーク可視化モデル
            * NetWorkX
            * 入力文字列に対して関連文字列を10個生成
            * それらをもとに入力文字列＋生成文字列の二次元配列を生成
            * 二次元配列をもとにそれらの形態素解析
            * 形態素解析の結果を二次元配列上に格納
            * 閾値を設定し、その閾値より下回った数値はすべて「関連性があるとは言えない」とする。
            * 閾値を超えた数値は「関連性がある」と考え数値に反映し、意味関連性ネットワークのエッジに入れる
            * 意味関係性生成ネットワークを作成する
            * 以外とグラフに日本語を反映させるのが難しかった
![7505cfc0-2cb2-4960-8fc2-ffa288bf4005.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/2502107/14a8f18d-1479-cb9b-a617-21b397299f71.png)
        * ヒートマップで可視化を試みる
            * 二次元配列上に関連する文字列の対応表を作成
            * 作成した、二次元配列に文字列の形態素解析の結果を埋め込む
            * 0.5以下を閾値として、観測することで関連性の高い類語を想起する模様を観測している
 ![89f004b0-3cd8-421d-b28e-dfd171a810e5.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/2502107/72404c6c-be26-aa10-177d-765d197e2042.png)
        * ネットワークグラフ
            * ネットワークグラフはヒートマップで作成した二次元配列をもとに作成
            * 関連数の切り落としが少なく、情報のつながりが多ければノードは大きくなり、エッジはその数値により太さを増す。
            * エッジの太さやノードの大きさを機械がわかるように作るのは意外と出来たが、グラフにするため、人間が観測可能な差にするのが難しかった。
            * 4月に学習した知識を用いて実装を行ったため、スムーズな実装ができた
![93d3586a-a53e-4415-a2eb-b4d93f6dba3a.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/2502107/43cb0e6d-cadb-284b-a6a5-d8dc870cce20.png)
        * SAPネットワークの構築を開始
            * 教授にプレゼン後、データの保存をし、テーブルとして値を持つ必要があることがわかった
            * 大きなデータになるので保存方法を考慮する必要があった。
            * CSV、Excel、バイナリ、HDF5が候補として挙がった。
            * HDF5形式は大容量のデータセットを効率的に保存するためのファイル形式であるため、採択。
            * 参考サイトの少なさから一時的にSQLを採択
            * SQLをテストし、全語句のデータの保存をしてみた
            * SQLでは、VisualStudioCodeの拡張機能が使いづらく、SQLite3に変更した
            * SQLite->dataframe->変更->dataframe->変更を保存->SQLiteの完成
            * 上記の方法では変更件数に関わらず、全件で1分30秒かかる。
            * 変更に時間がかかりすぎな点が課題であるため、データの更新方法を検討
            * SQLからPythonに値を渡さず、直接書き込むことで一件当たり0.1秒以内
            * 拡散ネットワークを作るために、その基盤となるデータセットをSQLに保存
            * 拡散ネットワークに対し、類似度の高いものを想起する事からそれらを加点するため拡散数を３と仮定し拡散
            * また、拡散ネットワークを作るために、関連文字列に拡散し、ループ一回を拡散と見なしたとき、一回目の入力を除き、n=3の時,3,9,27のように、3^(n-1)のように増えていく。
            * また実行時間は、0.7,0.8,0.8,4.0,5.9,15.9となっており、線形的に増えている
            * プログラム自体の計算量はO(N^2)になっている。
            * 拡散した値を仮に0.3として全部をSQLに書き込む処理を追加→成功
            * SQLから元の値を取得し、Scoreを加算していくことで活性値を表現
            * 活性値が閾値を超えたらループが止まるようにしたいが、5以上の数値は計算上現実的ではない
            * 活性値を超えたら。という考え方自体が並列処理でないため、同時に超えるはずが計算の手順により結果がランダムに決まってしまうことに気づいた。
            * そのため、理論上下記の仕様に変更する必要がある
            * 活性値を超えたら→活性回数の上限回数を決め、最大の活性値を活性化とする。
            * 活性化の状態を棒グラフに出力していく
            * 保存先を"%Y%m%d%H%M%S"でフォーマットすることにより、読込先のデータベースが毎秒変化する仕様を加えた
            * そのため、一回実行したらその後のデータは初期化される。しかし、dataframeでmodel内を走査しデータ基盤を作成するため毎回整った基盤の実現をしている。
            * SQLを採用し、データの保存場所Tempの役割を担うことで活性値をdataframeに保存
![download.gif](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/2502107/93337fb3-7de9-4b51-ad46-abf8a7867a6f.gif)
            * 入力文字列「赤」
1位	-> 黄色      	5.763988
2位	-> 白       	4.647908
3位	-> 青       	4.169025
4位	-> 赤       	4.027437
5位	-> 青色      	3.254387
6位	-> 赤色      	2.560124
7位	-> 緑色      	1.731792
8位	-> 黒       	1.712290
9位	-> 白色      	1.703744
10位	-> 橙色      	0.873102


## 2023/05/29～2023/06/04の活動

# SAPnetを作成する
## 二次元マップをテスト
二次元マップで中心にエージェントを仮想的に配置した
10個のランダムな距離と中心からの角度を生成し、それらを点P群とした
それらの点P群は距離は0～500cm(5m)で、角度は0～360°の値をとっている
それらの点P群を二次元マップに書き込んで表示している
![a9ce7eb9-e6f0-49bf-a003-e9213a63fcbd.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/2502107/23831501-810d-85e0-c0e5-27f0c06e7b0a.png)

さらに線を追加して中心からの距離を可視化
![6ac57f35-aba0-49af-94ba-014cb3e20464.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/2502107/1b748d2e-a9e8-ed38-856f-937cdc0bdb2d.png)

情報を保存する必要があることに気づく。
情報は下記の通りである
| 知識名       | 角度Θ(°) | 距離r(m) | 
| ------------ | ---- | ---- | 
| 直進         | 320  | 4    | 
| 右寄りの直進 | 340  | 2    | 
| 直進         | 0    | 1    | 
| 右寄りの直進 | 20  | 2    | 
| 直進         | 40    | 4    |
 

## 2023/04/01～2023/04/02の活動


Ask AI to edit or generate...
